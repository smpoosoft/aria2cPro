# Aria2c Pro Manager

**Aria2c Pro Manager** 是一款单 HTML 文件的 `aria2c` 命令生成与管理工具。它通过可视化操作配置 `aria2c` 参数，生成可直接在终端运行的下载命令，并提供下载历史记录管理功能。

## 🛠️ 主要功能

- **命令生成**：实时根据 URL、文件名、保存路径及高级参数（并发线程、预分配模式、断点续传）生成标准的 `aria2c` 命令。
- **参数配置**：
    - **全分配模式支持**：包含 `falloc`, `trunc`, `prealloc`, `sparse`, `none` 全部五种官方预分配选项。
    - **断点续传**：默认集成 `-c` 参数，确保任务可连续执行。
- **便捷粘贴交互**：
    - **点击即粘贴**：URL 与 Directory 输入框支持点击直接读取剪贴板并覆盖原有内容，支持多次点击重复覆盖。
    - **自动文件名解析**：粘贴 URL 时自动提取文件名并填充至 `-o` 参数字段。
- **历史记录管理**：
    - **本地存储**：利用浏览器 IndexedDB 记录所有生成的命令，页面刷新或关闭不丢失。
    - **物理文件联动**：在获得目录授权后，删除历史记录时可选择同步删除磁盘上的对应文件及其 `.aria2` 碎片。
- **界面布局**：采用响应式 Grid 布局，左侧为可搜索/管理的下载历史，右侧为参数配置面板。

## 📖 使用说明

1. **运行**：使用 Chrome 或 Edge 浏览器打开 `aria2c_pro.html`。
2. **配置**：
    - 点击 **URL** 粘贴下载地址。
    - 点击 **Directory** 粘贴保存路径。
    - 根据需要调整 **Threads**（线程数）及 **Allocation**（磁盘预分配策略）。
3. **复制**：点击底部绿色命令区域，命令将自动复制到剪贴板，同时该任务会保存至左侧历史列表。
4. **授权（可选）**：如需在删除记录时同步删除磁盘文件，需先点击左侧 **🔐 授权删除权限** 按钮选择下载根目录。

## 📂 数据库维护

由于早期版本开发迭代导致 IndexedDB 数据库名多次变更，若发现浏览器缓存中存在多个旧库（如 `Aria2_Final_vX`, `Aria2cPro_Storage` 等），可进行手动清理：

1. 按 `F12` 打开开发者工具，进入 **Console (控制台)**。
2. 输入 `handler.deepCleanDBS()` 并回车。
3. 确认后，系统将删除所有已知命名的旧版冗余库，仅保留当前活跃的唯一库 `Aria2c_Pro_Global`。

## ⚠️ 技术说明

- **无依赖**：纯原生 HTML/CSS/JS 实现，无任何第三方库。
- **隐私保护**：所有操作均在本地浏览器完成，不连接后端服务器，不上传任何路径或地址信息。
- **API 兼容性**：物理删除功能依赖 `File System Access API`，建议在基于 Chromium 的现代浏览器中使用。
